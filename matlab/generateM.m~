function M = generateM

Horizon = 100;
nPole = 256;
nr = 10;

n = 1:Horizon;
r = linspace(0.9, 1.1, nr);
theta = linspace(0,2*pi,nPole+1);
theta(end) = [];
unit_circle = exp(1i*theta);
cplx_p = r' * unit_circle;
cplx_p = cplx_p(:);
cplx_p = [0 1 cplx_p];

P = bsxfun(@power, cplx_p, n');

Mr = real(P);
Mi = imag(P);

M = [Mr Mi];

end